# Exercices

Au travers des exercices suivants, vous allez pouvoir manipuler les widgets et le mÃ©canisme de signal/slot sur la base du cours, des Ã©lÃ©ments vus prÃ©cÃ©demment et de vos recherches dans la documentation.

![qt-16](../images/cours/bts-2/90/qt-16.png)

CrÃ©er une application graphique QT Widgets dont le titre est **TP QT BTS2** et qui servira de projet pour lâ€™**ensemble des exercices**.
    
## Exercice 1

!!! abstract "Objectifs"

    +   CrÃ©er des boutons
    
    +   Leur affecter des actions avec le designer et avec le code.

1. Ajouter 4 boutons Ã  lâ€™aide du designer :
    
    ![qt-17](../images/cours/bts-2/90/qt-17.png)
    
2. Utiliser l'association des signaux et slots ( ++f4++ ) pour rÃ©aliser ces 3 actions :

    - Bouton **Agrandir** affiche la fenÃªtre en taille maximale.

    - Bouton **Normal** affiche la fenÃªtre dans sa taille d'origine

    - Bouton **Quitter** ferme l'application

3. Utiliser la **connexion par le code** pour rÃ©aliser l'action suivante :

    - Bouton **RÃ©duire** rÃ©duit la fenÃªtre dans la barre des tÃ¢ches (MainWindow).

## Exercice 2

!!! abstract "Objectifs"

    +   ModifierÂ un widget crÃ©Ã© via le designer par le code

    +   Faire communiquer deux widgets en utilisant le designer.

1. Ajouter un widget ComboBox et un widget LineEdit via le designerÂ :
    
    ![qt-18](../images/cours/bts-2/90/qt-18.png)
    
2. Remplir la ComboBox avec la mÃ©thode `addItem()` de la classe `QComboBox` depuis le constructeur de la `MainWindow` (en utilisant `ui`).

3. Utiliser l'association des signaux et slots (F4) pour remplacer le texte du LineEdit par le texte de lâ€™item sÃ©lectionnÃ© dans la ComboBox.

## CrÃ©ation de signals et de slots

<object class="fullScreenAble" data="../../pdf/cours/bts2/bts2_qt_05.pdf" type="application/pdf"></object>

## Exercice 3

!!! abstract "Objectifs"

    CrÃ©er un slot et le connecter Ã  des widgets.

1. Ajouter un GroupBox et y ajouter deux RadioButton.
    
    ![qt-19](../images/cours/bts-2/90/qt-19.png)
    
    Suivant la sÃ©lection, une image sera affichÃ©e ou non au fond de la fenÃªtre.
    
2. Ajouter un slot `changeBackground()` dans la classe `MainWindow` pour traiter la sÃ©lection des `QRadioButton`. La dÃ©finition de la mÃ©thode sera traitÃ©e plus loin dans lâ€™exercice.

3. Par programmation, dans le constructeur de la `MainWindow`, connecter (avec la primitive `connect`) le signal `clicked()` des deux `QRadioButton` au slot `changeBackground()`.

4. Ajouter une image en tant que ressource du projetÂ :

    1. Dans lâ€™arborescence, cliquer-droit sur le nom du projet et choisir **Add newâ€¦**

    2. Dans la fenÃªtre, choisir **Qt > Qt Resource File** et cliquer sur **Chooseâ€¦**
        
        ![qt-20](../images/cours/bts-2/90/qt-20.png)
        
    3. Nommer le fichier **resources.qrc** et valider les Ã©tapes suivantes

    4. Double-cliquer sur le nouveau fichier

    5. Cliquer sur **Add Prefix**

    6. Modifier la valeur du **PrÃ©fixe**Â pour **/images**

    7. Copier-coller une image (800x600) au choix dans le dossier du projet via lâ€™explorateur Windows

    8. Cliquer sur **Add Files**

    9. SÃ©lectionner lâ€™image et valider
        
        ![qt-21](../images/cours/bts-2/90/qt-21.png)
        
    10. Sauvegarder le fichier **resources.qrc**

5. En fonction du `QRadioButton` cochÃ© (`checked`), utiliser la mÃ©thode `setStyleSheet()` de la classe `MainWindow` pour changer lâ€™image de fond du widget centralÂ avec une des valeurs suivantes :
    
    ```cpp
    // Utiliser une image pour le fond d'Ã©cran
    "#centralwidget { background-image: url(:/images/{nom_de_l_image.jpg); }"
    
    // Masquer l'image en fond d'Ã©cran
    "#centralwidget { background-image: none; }"
    ```
    
## Exercice 4

!!! abstract "Objectifs"

    RÃ©cupÃ©rer une valeur de lâ€™IHM depuis un slot crÃ©Ã©.

On veut pouvoir modifier le titre de la fenÃªtre aprÃ¨s avoir saisi une valeur dans un widget LineEdit et appuyÃ© sur EntrÃ©e.

Peut-on le faire directement depuis le designerÂ ? PourquoiÂ ?

1. Ajouter un widget **LineEdit**.
    
    ![qt-22](../images/cours/bts-2/90/qt-22.png)
    
2. CrÃ©er un slot `changeWindowTitle()` dans la classe `MainWindow`.

3. RÃ©cupÃ©rer la valeur du widget `QLineEdit` et la passer Ã  la mÃ©thode `setWindowTitle()` de la classe `MainWindow`.

4. Avec le designer, rÃ©aliser la connexion nÃ©cessaire pour rÃ©pondre au besoin. 

Si le slot crÃ©Ã© nâ€™apparaÃ®t pas dans la liste, il faut lâ€™ajouter en utilisant le bouton **Editerâ€¦** de la fenÃªtre **Configurer connexion**.
    
![qt-23](../images/cours/bts-2/90/qt-23.png)

## Repartir du bon pied

Projet avec les 4 premiers exercices : ğŸ“‚[TP_QT_BTS2](../files/bts2/TP_QT_BTS2.zip)

## Exercice 5

!!! abstract "Objectifs"

    +   Passer des valeurs dâ€™un widget Ã  un autre
    +   CrÃ©er et Ã©mettre un signal

On souhaite rÃ©aliser une calculatrice "simple"Â :

![qt-36](../images/cours/bts-2/90/qt-36.png)

+ Elle est composÃ©e de deux **sliders** qui pilotent lâ€™affichage de deux **LCDNumber**.

+ Le **+** central est affichÃ© Ã  lâ€™aide dâ€™un label.

+ Lâ€™affichage sombre des **LCDNumber** est rÃ©alisÃ© en passant la propriÃ©tÃ© **segmentStyle** Ã  **Flat**.

**RÃ©aliser cette premiÃ¨re partie** de lâ€™exercice avec le designer.

![qt-37](../images/cours/bts-2/90/qt-37.png)

Au clic sur le bouton **=**, la somme des deux valeurs de **sliders** doit sâ€™afficher dans un troisiÃ¨me **LCDNumber**. Toutefois, le signal clicked() de la classe QPushButton nâ€™a pas de paramÃ¨tre de type entier etÂ  permet encore moins dâ€™envoyer deux valeurs qui ne lui appartiennent pas.

![qt-38](../images/cours/bts-2/90/qt-38.png)

Le clic sur le `QPushButton` va devoir dÃ©clencher un slot (Ã  crÃ©er) dans la classe `MainWindow` qui va lui-mÃªme Ã©mettre un signal au bon format (Ã  crÃ©er) qui sera connecter au slot `display(int)` du troisiÃ¨me `QLCDNumber`.

**RÃ©aliser cette seconde partie** pour terminer la Â«Â calculatriceÂ Â».

## Exercice 6

!!! abstract "Objectifs"

    +   Utiliser les slots de manipulation de texte.
    +   Personnaliser un widget avec une image

1. Ajouter sur la fenÃªtre un widget Textedit et deux boutons Copier et Coller pour copier ou coller du texte dans notre boite de texte.
    
    Les icones sont modifiables dans la fenÃªtre des propriÃ©tÃ©s via lâ€™attribut Â«Â Marche normaleÂ Â» de lâ€™attribut icon des `QAbstractButton`. On peut trouver de nombreuses icones libres de droits sur Internet, par exemple sur le site [iconmonstr.com](https://iconmonstr.com/).
    
2. Ajouter une icÃ´ne aux deux boutons en important au prÃ©alable deux icones dans le fichier resources.qrc.
    
    ![qt-39](../images/cours/bts-2/90/qt-39.png)
    
3. Utiliser l'association des signaux et slots ( ++f4++ ) pour finir lâ€™exercice.

## Exercice 7

!!! abstract "Objectifs"

    Comprendre le fonctionnement des progressBar.

1. Ajouter un widget Progress bar et un bouton Lancer.
    
    ![qt-40](../images/cours/bts-2/90/qt-40.png)
    
    Il va falloir dans le slot du bouton faire une boucle allant de 0 Ã  100 et qui sera temporisÃ©e Ã  chaque tour pendant 100ms. Pour temporiser le programme, on utilisera la mÃ©thode `msleep(int)` de la classe `QThread` qui suspend le thread.
    
2. Lancer la progression de la barre en prenant comme unitÃ© le centiÃ¨me de seconde.

??? danger "Aller plus loin"

    Temporiser avec `QThread::msleep()` met en sommeil le thread de l'application et bloque l'utilisation de l'IHM ğŸ˜¥

    Etudier l'utilisation de la classe `QTimer` et l'implÃ©menter pour ne pas paralyser l'application.